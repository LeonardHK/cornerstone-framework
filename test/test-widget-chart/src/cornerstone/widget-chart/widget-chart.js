/*
    Cornerstone Framework v0.9.1

    COPYRIGHT(C) 2012 BY SKTELECOM CO., LTD. ALL RIGHTS RESERVED.
    Released under the Apache License, Version 2.0
*/
!function(){"use strict";function a(a,b){var c=d3.select(a);"object"==typeof b&&"object"==typeof b.color&&b.color.length>0&&(b.color=d3.scale.ordinal().range(b.color)),this.options=b,this.$el=$(a),nv.dev=!1,this[b.chartType+"Chart"](c,b)}var b,c=this,d="featuredChart";a.prototype={barChart:function(a,b){nv.addGraph(function(){var c=nv.models.multiBarChart();return c.xAxis.axisLabel(b.xAxisLabel).tickFormat(d3.format(",f")),c.yAxis.axisLabel(b.yAxisLabel).tickFormat(d3.format(",.1f")),c.color(b.color.range()),a=a.select("svg").length>0&&null===a.select("svg")[0][0]?a.append("svg:svg"):a.select("svg"),a.datum(b.data).transition().duration(500).call(c),!b.autoResize||nv.utils.windowResize(c.update),c})},stackedBarChart:function(a,b){nv.addGraph(function(){var c=nv.models.multiBarChart();return c.stacked(!0),c.xAxis.axisLabel(b.xAxisLabel).tickFormat(d3.format(",f")),c.yAxis.axisLabel(b.yAxisLabel).tickFormat(d3.format(",.1f")),c.color(b.color.range()),a=a.select("svg").length>0&&null===a.select("svg")[0][0]?a.append("svg:svg"):a.select("svg"),a.datum(b.data).transition().duration(500).call(c),!b.autoResize||nv.utils.windowResize(c.update),c})},groupedBarChart:function(a,b){nv.addGraph(function(){var c=nv.models.multiBarChart();return c.stacked(!1),c.xAxis.axisLabel(b.xAxisLabel).tickFormat(d3.format(",f")),c.yAxis.axisLabel(b.yAxisLabel).tickFormat(d3.format(",.1f")),c.color(b.color.range()),a=a.select("svg").length>0&&null===a.select("svg")[0][0]?a.append("svg:svg"):a.select("svg"),a.datum(b.data).transition().duration(500).call(c),!b.autoResize||nv.utils.windowResize(c.update),c})},lineChart:function(a,b){nv.addGraph(function(){var c=nv.models.lineChart();return c.xAxis.axisLabel(b.xAxisLabel).tickFormat(d3.format(",f")),c.yAxis.axisLabel(b.yAxisLabel).tickFormat(d3.format(",.1f")),c.color(b.color.range()),a=a.select("svg").length>0&&null===a.select("svg")[0][0]?a.append("svg:svg"):a.select("svg"),a.datum(b.data).transition().duration(500).call(c),!b.autoResize||nv.utils.windowResize(c.update),c})},pieChart:function(a,b){var c=500,d=500;nv.addGraph(function(){var e=nv.models.pieChart().x(function(a){return a.key}).y(function(a){return a.y}).values(function(a){return a}).color(b.color.range());return a=a.select("svg").length>0&&null===a.select("svg")[0][0]?a.append("svg:svg"):a.select("svg"),a.datum([b.data]).transition().duration(1200).attr("width",c).attr("height",d).call(e),$.each(a.selectAll(".nv-slice > .nv-label > text")[0],function(a,b){$(b).removeAttr("style")}),!b.autoResize||nv.utils.windowResize(e.update),e})},horizontalBarChart:function(a,b){nv.addGraph(function(){var c=nv.models.multiBarHorizontalChart().x(function(a){return a.x}).y(function(a){return a.y}).showValues(!0).tooltips(!1).showControls(!1);return c.yAxis.tickFormat(d3.format(",.2f")),a=a.select("svg").length>0&&null===a.select("svg")[0][0]?a.append("svg:svg"):a.select("svg"),a.datum(b.data).transition().duration(500).call(c),!b.autoResize||nv.utils.windowResize(c.update),e(a),c})},linePlusBarChart:function(a,b){var c=[{key:"Quantity",bar:!0,values:[[11360052e5,1271e3],[11386836e5,1271e3],[11411028e5,1271e3],[11437812e5,0],[11463696e5,310],[1149048e6,123410],[115164e7,53340],[11543184e5,4320],[11569968e5,0],[11595888e5,3899486],[11622708e5,3899486],[11648628e5,3899486],[11675412e5,3564700],[11702196e5,3564700],[11726388e5,3564700],[11753136e5,2648493],[11779056e5,2648493],[1180584e6,2648493],[1183176e6,2522993],[11858544e5,2522993]]},{key:"Price",values:[[11360052e5,71.89],[11386836e5,75.51],[11411028e5,68.49],[11437812e5,62.72],[11463696e5,70.39],[1149048e6,59.77],[115164e7,57.27],[11543184e5,67.96],[11569968e5,67.85],[11595888e5,76.98],[11622708e5,81.08],[11648628e5,91.66],[11675412e5,84.84],[11702196e5,85.73],[11726388e5,84.61],[11753136e5,92.91],[11779056e5,99.8],[1180584e6,121.191],[1183176e6,122.04],[11858544e5,131.76],[11885328e5,138.48],[11911248e5,153.47],[11938032e5,189.95],[11963988e5,182.22],[11990772e5,198.08]]}];nv.addGraph(function(){var d=nv.models.linePlusBarChart().x(function(a,b){return b}).y(function(a){return a[1]}).color(d3.scale.category10().range());return d.xAxis.showMaxMin(!1).tickFormat(function(a){var b=c[0].values[a]&&c[0].values[a][0]||0;return d3.time.format("%x")(new Date(b))}),d.y1Axis.tickFormat(d3.format(",f")),d.y2Axis.tickFormat(function(a){return"$"+d3.format(",f")(a)}),d.bars.forceY([0]),a=a.select("svg").length>0&&null===a.select("svg")[0][0]?a.append("svg:svg"):a.select("svg"),a.datum(c).transition().duration(500).call(d),!b.autoResize||nv.utils.windowResize(d.update),e(a),d})},lineFocusChart:function(a,b){function c(){return d(3,10+200*Math.random(),.1).map(function(a,b){return{key:"Stream"+b,values:a}})}function d(a,b,c){function d(a){for(var c=1/(.1+Math.random()),d=2*Math.random()-.5,e=10/(.1+Math.random()),f=0;b>f;f++){var g=(f/b-d)*e;a[f]+=c*Math.exp(-g*g)}}return arguments.length<3&&(c=0),d3.range(a).map(function(){var a,e=[];for(a=0;b>a;a++)e[a]=c+c*Math.random();for(a=0;5>a;a++)d(e);return e.map(f)})}function f(a,b){return{x:b,y:Math.max(0,a)}}nv.addGraph(function(){var d=nv.models.lineWithFocusChart();return d.xAxis.tickFormat(d3.format(",f")),d.yAxis.tickFormat(d3.format(",.2f")),d.y2Axis.tickFormat(d3.format(",.2f")),a=a.select("svg").length>0&&null===a.select("svg")[0][0]?a.append("svg:svg"):a.select("svg"),a.datum(c()).transition().duration(500).call(d),!b.autoResize||nv.utils.windowResize(d.update),e(a),d})}};var e=function(a){$(a.selectAll(".nv-line .nv-group")).each(function(){$(this).removeAttr("style")});var b=a.selectAll(".nv-series circle");b.length&&$(b).each(function(){$(this).removeAttr("style")})};if($.fn.featuredChart=function(c){return b={chartType:"bar",lineType:"basis",xAxisLabel:null,yAxisLabel:null,width:960,height:600,margin:[0,0,0,0],padding:[0,0,0,0],data:{},animate:!1,controlBar:!1,filtering:!0,autoResize:!0,color:d3.scale.category10()},c=$.extend(!0,b,c),this.each(function(){var b=$(this),e=b.data(d);"string"==typeof c?e[c](e.options):(e=new a(this,c),b.data(d,e)),c.filtering?b.addClass("filtering"):b.removeClass("filtering"),c.controlBar?b.addClass("control-bar"):b.removeClass("control-bar")})},$.fn.featuredChart.Constructor=a,c.activeDataApi=function(a){a=a&&a.length?a.find("[data-featured=chart]"):$("[data-featured=chart]"),a.each(function(){var a=this,b=$(this).data("chartBind");$.getJSON(b).success(function(b){$(a)[d]({chartType:$(a).data("chartType"),data:b})}).error(function(a,b,c){console.log("getJSON Error",a,b,c)})})},$(function(){c.activeDataApi()}),"function"==typeof c.define&&c.define.amd&&"object"==typeof c.Cornerstone){var f=c.define;f(["jquery","underscore","backbone"],function(a,b,c){return c.View.extend({model:new c.Model,initialize:function(){b.bindAll(this,"render")},updateChart:function(b){b.model.clear(),b.model.fetch({success:function(c){var d=[];a.each(c.toJSON(),function(a,b){d.push(b)}),b.options=a.extend({},b.options,{data:d}),b.$el.featuredChart(b.options)}})},render:function(){return this.$el.featuredChart(this.options),this.updateChart(this),this}})})}}.call(this);