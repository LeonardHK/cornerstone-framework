/*
    Cornerstone Framework v0.9.1

    COPYRIGHT(C) 2012 BY SKTELECOM CO., LTD. ALL RIGHTS RESERVED.
    Released under the Apache License, Version 2.0
*/
!function(){"use strict";var a,b,c,d,e=this,f="featuredScrollView",g=".cs.scrollView",h=[{eventName:"pullDown",callbackName:"pullDownAction"},{eventName:"pullUp",callbackName:"pullUpAction"},{eventName:"refresh",callbackName:"onRefresh"},{eventName:"beforeScrollStart",callbackName:"onBeforeScrollStart"},{eventName:"start",callbackName:"onScrollStart"},{eventName:"beforeScrollMove",callbackName:"onBeforeScrollMove"},{eventName:"move",callbackName:"onScrollMove"},{eventName:"beforeScrollEnd",callbackName:"onBeforeScrollEnd"},{eventName:"scrollEnd",callbackName:"onScrollEnd"},{eventName:"touchEnd",callbackName:"onTouchEnd"},{eventName:"destroy",callbackName:"onDestroy"}],i=function(a,b){var c={scrollbars:!0,mouseWheel:!0,scrollbarClass:"scrollViewBar",interactiveScrollbars:!0,formFields:void 0,pullDownAction:void 0,pullUpAction:void 0,onRefresh:void 0,onBeforeScrollStart:void 0,onScrollStart:void 0,onBeforeScrollMove:void 0,onScrollMove:void 0,onBeforeScrollEnd:void 0,onScrollEnd:void 0,onTouchEnd:void 0,onDestroy:void 0};return this.$el=$(a),this.options=$.extend(!0,c,b),this.formCheck(),this.pullToRefresh(),this.$el.off("touchmove"+g).on("touchmove"+g,function(a){console.log(a.target.type),"range"!==a.target.type&&a.preventDefault()}),this.$el.off("mouseover"+g).on("mouseover"+g,function(){$(window).on("mousewheel"+g+" DOMMouseScroll"+g,function(a){var b=a.wheelDelta||-a.detail;this.scrollTop+=30*(0>b?1:-1),a.preventDefault()})}).off("mouseout"+g).on("mouseout"+g,function(){$(window).off("mousewheel"+g+" DOMMouseScroll"+g)}),this.options=this.addEventListener(this.options),this.iscroll=new iScroll(this.$el[0],this.options),this};if(i.prototype.addEventListener=function(a){var b=this;return $(h).each(function(){var c=this,d=a[c.callbackName];a[c.callbackName]=function(){"function"==typeof d?d.call(this,arguments):d=function(){},b.$el.trigger(c.eventName+g)}}),a},i.prototype.destroy=function(){this.iscroll.destroy(),this.$el.off("touchmove"+g),this.$el.off("mouseover"+g),this.$el.off("mouseout"+g),$(window).off("mousewheel"+g+" DOMMouseScroll"+g),this.$el.data(f,null)},i.prototype.refresh=function(){this.iscroll.refresh()},i.prototype.formCheck=function(){if(!(!$.isEmptyObject(this.options)&&$.isArray(this.options.formFields)&&this.options.formFields.length>0))return!1;var a=this,b=function(b){for(var c=b.target,d=!0;1!=c.nodeType;)c=c.parentNode;$.grep(a.options.formFields,function(a){d=d&&c.tagName!=a}),d&&b.preventDefault()};this.defaultOptions.onBeforeScrollStart=b},i.prototype.pullToRefresh=function(){var e=this;if(a=e.$el.find('[data-featured-scrollview="pullDown"]'),c=e.$el.find('[data-featured-scrollview="pullUp"]'),!(this.options&&a.length&&c.length))return!1;b=a&&a[0].offsetHeight,d=c&&c[0].offsetHeight;var f=b,g=function(){a=e.$el.find('[data-featured-scrollview="pullDown"]'),b=a&&a[0].offsetHeight,c=e.$el.find('[data-featured-scrollview="pullUp"]'),d=c&&c[0].offsetHeight,a&&a.attr("class").match("loading")?a.removeClass("flip loading"):c&&c.attr("class").match("loading")&&c.removeClass("flip loading")},h=function(){a=e.$el.find('[data-featured-scrollview="pullDown"]'),b=a&&a[0].offsetHeight,c=e.$el.find('[data-featured-scrollview="pullUp"]'),d=c&&c[0].offsetHeight,this.y>5&&a&&!a.attr("class").match("flip")?(a.addClass("flip"),this.minScrollY=0):this.y<5&&a&&a.attr("class").match("flip")?(a.removeClass("flip loading"),this.minScrollY=-b):this.y<this.maxScrollY-5&&c&&!c.attr("class").match("flip")?(c.addClass("flip"),this.maxScrollY=this.maxScrollY):this.y>this.maxScrollY+5&&c&&c.attr("class").match("flip")&&(c.removeClass("flip loading"),this.maxScrollY=d)},i=function(){a=e.$el.find('[data-featured-scrollview="pullDown"]'),b=a&&a[0].offsetHeight,c=e.$el.find('[data-featured-scrollview="pullUp"]'),d=c&&c[0].offsetHeight,a&&a.attr("class").match("flip")?(a.addClass("loading"),e.options.pullDownAction&&e.options.pullDownAction()):a&&c.attr("class").match("flip")&&(c.addClass("loading"),e.options.pullUpAction&&e.options.pullUpAction())};this.options.topOffset=f,this.options.onRefresh=g,this.options.onScrollMove=h,this.options.onScrollEnd=i},$.fn[f]=function(a){return this.each(function(){var b=$(this),c=b.data(f);c||b.data(f,c=new i(this,a)),"string"==typeof a&&c[a](c.options)})},$(function(){$("[data-featured=scrollView]").each(function(){$(this)[f]()})}),"function"==typeof e.define&&e.define.amd){var j=e.define;j(["backbone","underscore","jquery"],function(a,b){return a.View.extend({render:function(){return b.extend(this,this.$el.featuredScrollView(this.options).data("featuredScrollView")),this}})})}}.call(this);