/*
    Cornerstone Framework v0.9.1

    COPYRIGHT(C) 2012 BY SKTELECOM CO., LTD. ALL RIGHTS RESERVED.
    Released under the Apache License, Version 2.0
*/
!function(a,b,c){"function"==typeof define&&define.amd?define(["backbone","underscore","jquery"],function(d,e,f){return c(f,a,b),d.View.extend({tagName:"ul",initialize:function(){e.bindAll(this,"render")},addItem:function(a,b){var c=document.createElement(this.tagName);b.each(function(b){f(c).append(new a.options.itemView({model:b}).render().el)}),a.$el.featuredListView("addItem",c)},removeItem:function(a,b){return this.$el.featuredListView("removeItem",a,b)},updateListView:function(a){a.collection.fetch({success:function(b){a.addItem(a,b)}})},render:function(){return this.$el.featuredListView(this.options),this.updateListView(this),this}})}):c(a.jQuery,a,b)}(this,document,function(a,b,c){var d,e,f,g="featuredListView",h=function(g,h){var i=this;f={optimization:!0,SCROLL_THROTTLE:0,scrollEndAction:function(){}},this.$el=a(g),this.options=h=a.extend(!0,f,h),infinity.config.SCROLL_THROTTLE=this.options.SCROLL_THROTTLE,d=infinity.ListView,e=infinity.ListItem,this.$el.each(function(){h.optimization&&(html=i.$el.html(),i.$el.html(""),listView=new d(a(this)),a(this).data("listView",listView),i.$el.data("listView").append(html),html="")}),this.scrollHeight=navigator.userAgent.match(":*iPhone:*")&&!b.navigator.standalone?60:0;var j=0;a(b).on("scroll",function(){j=navigator.userAgent.match("Android")?a(b).scrollTop()+100:a(b).scrollTop(),j>=a(c).height()-a(b).height()-i.scrollHeight&&(h.scrollEndAction(),i.$el.trigger("scrollEnd.cs.liveView"))})};return h.prototype.addItem=function(b,c){b.optimization?this.$el.data("listView").append(a(c)):this.$el.append(c),this.$el.trigger("listView.addItem.done")},h.prototype.removeItem=function(c,d,e){var f,g,h,i=0,j=0,k=0;if(c.optimization){if("undefined"==typeof e)for(g=this.$el.data("listView").find(d),i=0,f=g.length;f>i;i++)g[i].remove();else for(g=this.$el.data("listView").find(d),i=0,f=g.length;f>i;i++){for(j in e)h=g[i].$el.find("[data-list-itemid='"+e[j]+"']"),k+=h.height(),h.remove();g[i].parent.height=g[i].parent.height-k}b.scrollTo(b.scrollX,b.scrollY-a(c.spinner).height())}else{if("undefined"==typeof e)d.remove();else for(i in e)d.find("[data-list-itemid='"+e[i]+"']").remove();b.scrollTo(b.scrollX,b.scrollY-a(c.spinner).height())}this.refresh(),this.$el.trigger("listView.removeItem.done")},h.prototype.refresh=function(){var c=this.$el.data("listView"),d=0;a(c.pages).each(function(){d+=this.height}),c.height=d,this.$el.children("div").css({height:c.height}),b.scrollTo(b.scrollX,b.scrollY-a(options.spinner).height())},h.prototype.scrollHandler=function(){this.$el.data("listView").scrollHandler()},a.fn[g]=function(b,c,d){return this.each(function(){var e=a(this),f=e.data(g);f||e.data(g,f=new h(this,b)),"string"==typeof b&&f[b](f.options,c,d)})},a.fn[g].Constructor=h,a(function(){a("[data-featured=listView]").each(function(){a(this)[g]()})}),h});